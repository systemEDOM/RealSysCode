{"version":3,"sources":["../../src/controllers/snippet.controller.js"],"names":["validationResult","require","UserController","create","req","res","render","store","errors","isEmpty","flash","array","status","redirect","body","user","_id","SnippetRepository","then","newSnippet","slug","catch","error","updateByAjax","findOneAndUpdate","params","id","json","message","show","snippet","findBySlug","delete","result","header","module","exports"],"mappings":"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","sourcesContent":["import SnippetRepository from '../repositories/SnippetRepository';\r\nconst { validationResult } = require('express-validator');\r\n\r\nconst UserController = {\r\n    create: async (req, res) => {\r\n        res.render('snippets/create_snippet');\r\n    },\r\n    store: async (req, res) => {\r\n        const errors = validationResult(req);\r\n        if (!errors.isEmpty()) {\r\n            req.flash('errors', errors.array());\r\n            return res.status(400).redirect('/snippets/create');\r\n        }\r\n\r\n        req.body.user = req.user._id;\r\n        await SnippetRepository.create(req.body)\r\n            .then(newSnippet => {\r\n                req.flash('success', \"Snippet created successfully. Now write your code!\");\r\n                res.status(200).redirect(`/snippets/${newSnippet.slug}`);\r\n            }).catch(error => {\r\n                // console.log(error);\r\n                req.flash('error', \"An error has occured\");\r\n                res.status(400).redirect(\"/snippets/create\");\r\n            });\r\n    },\r\n    updateByAjax: async (req, res) => {\r\n        await SnippetRepository.findOneAndUpdate(req.params.id, req.body)\r\n            .then(newSnippet => {\r\n                res.status(200).json({ message: \"Saved successfully\" });\r\n            }).catch(error => {\r\n                // console.log(error);\r\n                res.status(400).json({ message: \"An error has occured\" });\r\n            });\r\n    },\r\n    show: async (req, res) => {\r\n        const snippet = await SnippetRepository.findBySlug(req.params.slug);\r\n        res.render('snippets/show_snippet', { snippet, user: req.user });\r\n    },\r\n    delete: async (req, res) => {\r\n        await SnippetRepository.delete(req.params.id)\r\n            .then(result => {\r\n                req.flash('success', \"Snippet deleted successfully!\");\r\n                res.status(200).redirect(req.header('Referer'));\r\n            }).catch(error => {\r\n                // console.log(error);\r\n                req.flash('error', \"An error has occured\");\r\n                res.status(400).redirect(req.header('Referer'));\r\n            });\r\n    },\r\n};\r\n\r\nmodule.exports = UserController;"],"file":"snippet.controller.js"}