{"version":3,"sources":["../../src/controllers/snippet.controller.js"],"names":["validationResult","require","UserController","create","req","res","render","store","errors","isEmpty","flash","array","status","redirect","body","user","_id","SnippetRepository","then","newSnippet","slug","catch","error","console","log","updateByAjax","findOneAndUpdate","params","id","json","message","show","snippet","findBySlug","module","exports"],"mappings":";;AAAA;;;;AACA,MAAM;AAAEA,EAAAA;AAAF,IAAuBC,OAAO,CAAC,mBAAD,CAApC;;AAEA,MAAMC,cAAc,GAAG;AACnBC,EAAAA,MAAM,EAAE,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACxBA,IAAAA,GAAG,CAACC,MAAJ,CAAW,yBAAX;AACH,GAHkB;AAInBC,EAAAA,KAAK,EAAE,OAAOH,GAAP,EAAYC,GAAZ,KAAoB;AACvB,UAAMG,MAAM,GAAGR,gBAAgB,CAACI,GAAD,CAA/B;;AACA,QAAI,CAACI,MAAM,CAACC,OAAP,EAAL,EAAuB;AACnBL,MAAAA,GAAG,CAACM,KAAJ,CAAU,QAAV,EAAoBF,MAAM,CAACG,KAAP,EAApB;AACA,aAAON,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,QAAhB,CAAyB,kBAAzB,CAAP;AACH;;AAEDT,IAAAA,GAAG,CAACU,IAAJ,CAASC,IAAT,GAAgBX,GAAG,CAACW,IAAJ,CAASC,GAAzB;AACA,UAAMC,2BAAkBd,MAAlB,CAAyBC,GAAG,CAACU,IAA7B,EACDI,IADC,CACIC,UAAU,IAAI;AAChBf,MAAAA,GAAG,CAACM,KAAJ,CAAU,SAAV,EAAqB,oDAArB;AACAL,MAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,QAAhB,CAA0B,aAAYM,UAAU,CAACC,IAAK,EAAtD;AACH,KAJC,EAICC,KAJD,CAIOC,KAAK,IAAI;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAlB,MAAAA,GAAG,CAACM,KAAJ,CAAU,OAAV,EAAmB,sBAAnB;AACAL,MAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,QAAhB,CAAyB,kBAAzB;AACH,KARC,CAAN;AASH,GArBkB;AAsBnBY,EAAAA,YAAY,EAAE,OAAOrB,GAAP,EAAYC,GAAZ,KAAoB;AAC9B,UAAMY,2BAAkBS,gBAAlB,CAAmCtB,GAAG,CAACuB,MAAJ,CAAWC,EAA9C,EAAkDxB,GAAG,CAACU,IAAtD,EACDI,IADC,CACIC,UAAU,IAAI;AAChBd,MAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBiB,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB;AACH,KAHC,EAGCT,KAHD,CAGOC,KAAK,IAAI;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAjB,MAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBiB,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB;AACH,KANC,CAAN;AAOH,GA9BkB;AA+BnBC,EAAAA,IAAI,EAAE,OAAO3B,GAAP,EAAYC,GAAZ,KAAoB;AACtB,UAAM2B,OAAO,GAAG,MAAMf,2BAAkBgB,UAAlB,CAA6B7B,GAAG,CAACuB,MAAJ,CAAWP,IAAxC,CAAtB;AACAf,IAAAA,GAAG,CAACC,MAAJ,CAAW,uBAAX,EAAoC;AAAE0B,MAAAA;AAAF,KAApC;AACH;AAlCkB,CAAvB;AAqCAE,MAAM,CAACC,OAAP,GAAiBjC,cAAjB","sourcesContent":["import SnippetRepository from '../repositories/SnippetRepository';\r\nconst { validationResult } = require('express-validator');\r\n\r\nconst UserController = {\r\n    create: async (req, res) => {\r\n        res.render('snippets/create_snippet');\r\n    },\r\n    store: async (req, res) => {\r\n        const errors = validationResult(req);\r\n        if (!errors.isEmpty()) {\r\n            req.flash('errors', errors.array());\r\n            return res.status(400).redirect('/snippets/create');\r\n        }\r\n\r\n        req.body.user = req.user._id;\r\n        await SnippetRepository.create(req.body)\r\n            .then(newSnippet => {\r\n                req.flash('success', \"Snippet created successfully. Now write your code!\");\r\n                res.status(200).redirect(`/snippets/${newSnippet.slug}`);\r\n            }).catch(error => {\r\n                console.log(error);\r\n                req.flash('error', \"An error has occured\");\r\n                res.status(400).redirect(\"/snippets/create\");\r\n            });\r\n    },\r\n    updateByAjax: async (req, res) => {\r\n        await SnippetRepository.findOneAndUpdate(req.params.id, req.body)\r\n            .then(newSnippet => {\r\n                res.status(200).json({ message: \"Saved successfully\" });\r\n            }).catch(error => {\r\n                console.log(error);\r\n                res.status(400).json({ message: \"An error has occured\" });\r\n            });\r\n    },\r\n    show: async (req, res) => {\r\n        const snippet = await SnippetRepository.findBySlug(req.params.slug);\r\n        res.render('snippets/show_snippet', { snippet });\r\n    },\r\n};\r\n\r\nmodule.exports = UserController;"],"file":"snippet.controller.js"}